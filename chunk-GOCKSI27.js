import{b as y}from"./chunk-M7YNLJA7.js";import{b as $,c as b,h as T}from"./chunk-RTAFBYSH.js";import{A as a,G as c,H as i,U as n,X as h,ba as l,g as v,k as s,p as u}from"./chunk-YXS2TKPT.js";import{a as f}from"./chunk-2VMXMS7J.js";var m=class o{http=l(b);config=l(T);list(t,e,r){let x=t-1,g=new $().set("page",String(x)).set("size",String(e));return r?.trim()&&(g=g.set("nome",r.trim())),this.http.get(`${this.config.apiBaseUrl}/v1/tutores`,{params:g}).pipe(u(p=>{let U=typeof p?.page=="number"?p.page+1:t;return{items:p?.content??p?.items??[],total:p?.total??0,page:U,size:p?.size??e}}))}getById(t){return this.http.get(`${this.config.apiBaseUrl}/v1/tutores/${t}`)}create(t){return this.http.post(`${this.config.apiBaseUrl}/v1/tutores`,t)}update(t,e){return this.http.put(`${this.config.apiBaseUrl}/v1/tutores/${t}`,e)}delete(t){return this.http.delete(`${this.config.apiBaseUrl}/v1/tutores/${t}`)}uploadPhoto(t,e){let r=new FormData;return r.append("foto",e),this.http.post(`${this.config.apiBaseUrl}/v1/tutores/${t}/fotos`,r)}deletePhoto(t,e){return this.http.delete(`${this.config.apiBaseUrl}/v1/tutores/${t}/fotos/${e}`)}vincularPet(t,e){return this.http.post(`${this.config.apiBaseUrl}/v1/tutores/${t}/pets/${e}`,{})}removerVinculo(t,e){return this.http.delete(`${this.config.apiBaseUrl}/v1/tutores/${t}/pets/${e}`)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"})};var P={selected:null,loadingDetail:!1,saving:!1,uploadingPhoto:!1,error:null};var d=class o{_state$=new v(P);state$=this._state$.asObservable();selected$=this.state$.pipe(u(t=>t.selected),c());loadingDetail$=this.state$.pipe(u(t=>t.loadingDetail),c());saving$=this.state$.pipe(u(t=>t.saving),c());uploadingPhoto$=this.state$.pipe(u(t=>t.uploadingPhoto),c());error$=this.state$.pipe(u(t=>t.error),c());get snapshot(){return this._state$.getValue()}patch(t){this._state$.next(f(f({},this.snapshot),t))}setSelected(t){this.patch({selected:t})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"})};var S=class o{deleteTutor(t){return this.store.patch({saving:!0,error:null}),this.api.delete(t).pipe(n(()=>this.snack.success("Tutor exclu\xEDdo com sucesso.")),a(e=>(this.store.patch({error:e?.error?.message??"Erro ao excluir tutor."}),s(null))),i(()=>this.store.patch({saving:!1})))}store=l(d);api=l(m);snack=l(y);selected$=this.store.selected$;loadingDetail$=this.store.loadingDetail$;saving$=this.store.saving$;uploadingPhoto$=this.store.uploadingPhoto$;error$=this.store.error$;loadTutorDetail(t){return this.store.patch({loadingDetail:!0,error:null,selected:null}),this.api.getById(t).pipe(n(e=>this.store.setSelected(e)),a(e=>(this.store.patch({error:e?.error?.message??"Erro ao carregar tutor."}),s(null))),i(()=>this.store.patch({loadingDetail:!1})))}createTutor(t){return this.store.patch({saving:!0,error:null}),this.api.create(t).pipe(n(e=>{this.store.setSelected(e),this.snack.success("Tutor criado com sucesso.")}),a(e=>(this.store.patch({error:e?.error?.message??"Erro ao criar tutor."}),s(null))),i(()=>this.store.patch({saving:!1})))}updateTutor(t,e){return this.store.patch({saving:!0,error:null}),this.api.update(t,e).pipe(n(r=>{this.store.setSelected(r),this.snack.success("Tutor atualizado com sucesso.")}),a(r=>(this.store.patch({error:r?.error?.message??"Erro ao atualizar tutor."}),s(null))),i(()=>this.store.patch({saving:!1})))}deleteTutorPhoto(t,e){return this.store.patch({uploadingPhoto:!0,error:null}),this.api.deletePhoto(t,e).pipe(n(()=>this.snack.success("Foto removida com sucesso.")),a(r=>(this.store.patch({error:r?.error?.message??"Erro ao remover foto."}),s(null))),i(()=>this.store.patch({uploadingPhoto:!1})))}uploadTutorPhoto(t,e){return this.store.patch({uploadingPhoto:!0,error:null}),this.api.uploadPhoto(t,e).pipe(n(()=>this.snack.success("Foto do tutor enviada.")),a(r=>(this.store.patch({error:r?.error?.message??"Erro ao enviar foto."}),s(null))),i(()=>this.store.patch({uploadingPhoto:!1})))}vincularPet(t,e){return this.store.patch({saving:!0,error:null}),this.api.vincularPet(t,e).pipe(n(()=>this.snack.success("Pet vinculado ao tutor.")),a(r=>(this.store.patch({error:r?.error?.message??"Erro ao vincular pet."}),s(null))),i(()=>this.store.patch({saving:!1})))}removerVinculo(t,e){return this.store.patch({saving:!0,error:null}),this.api.removerVinculo(t,e).pipe(n(()=>this.snack.success("V\xEDnculo removido.")),a(r=>(this.store.patch({error:r?.error?.message??"Erro ao remover v\xEDnculo."}),s(null))),i(()=>this.store.patch({saving:!1})))}static \u0275fac=function(e){return new(e||o)};static \u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"})};export{m as a,S as b};
